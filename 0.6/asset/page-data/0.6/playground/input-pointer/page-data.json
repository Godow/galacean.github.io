{"componentChunkName":"component---src-templates-playground-tsx","path":"/0.6/playground/input-pointer","result":{"pageContext":{"node":{"internal":{"content":"(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"oasis-engine\", \"@oasis-engine/physics-lite\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(require(\"oasis-engine\"), require(\"@oasis-engine/physics-lite\"));\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(global.oasisEngine, global[\"@oasisEngine/physicsLite\"]);\n    global.index = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_oasisEngine, _physicsLite) {\n  \"use strict\";\n\n  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }\n\n  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n  var engine = new _oasisEngine.WebGLEngine(\"canvas\", _physicsLite.LitePhysics);\n  engine.canvas.resizeByClientSize();\n  var invCanvasWidth = 1 / engine.canvas.width;\n  var invCanvasHeight = 1 / engine.canvas.height; // @ts-ignore\n\n  var inputManager = engine.inputManager;\n  var scene = engine.sceneManager.activeScene;\n  var rootEntity = scene.createRootEntity(\"root\");\n  scene.ambientLight.diffuseSolidColor.setValue(1, 1, 1, 1);\n  scene.ambientLight.diffuseIntensity = 1.2; // init camera\n\n  var cameraEntity = rootEntity.createChild(\"camera\");\n  var camera = cameraEntity.addComponent(_oasisEngine.Camera);\n  cameraEntity.transform.setPosition(10, 10, 10);\n  cameraEntity.transform.lookAt(new _oasisEngine.Vector3(0, 0, 0)); // init point light\n\n  var light = rootEntity.createChild(\"light1\");\n  light.transform.setPosition(-8, -2, 8);\n  light.addComponent(_oasisEngine.PointLight).intensity = 0.12;\n  light = rootEntity.createChild(\"light2\");\n  light.transform.setPosition(8, -2, 0);\n  light.addComponent(_oasisEngine.PointLight).intensity = 0.12;\n\n  var PanScript = /*#__PURE__*/function (_Script) {\n    _inheritsLoose(PanScript, _Script);\n\n    function PanScript() {\n      var _this;\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      _this = _Script.call.apply(_Script, [this].concat(args)) || this;\n      _this.startPointerPos = new _oasisEngine.Vector3();\n      _this.tempVec2 = new _oasisEngine.Vector2();\n      _this.tempVec3 = new _oasisEngine.Vector3();\n      _this.tempVec4 = new _oasisEngine.Vector4();\n      _this.zValue = 0;\n      return _this;\n    }\n\n    var _proto = PanScript.prototype;\n\n    _proto.onPointerDown = function onPointerDown() {\n      // get depth\n      camera.worldToViewportPoint(this.entity.transform.worldPosition, this.tempVec4).z;\n      this.zValue = (this.tempVec4.z + 1) / 2;\n      var tempVec2 = this.tempVec2,\n          tempVec3 = this.tempVec3; // @ts-ignore\n\n      this.getMergePointer(inputManager.pointers, tempVec2);\n      tempVec3.setValue(tempVec2.x * invCanvasWidth, tempVec2.y * invCanvasHeight, this.zValue);\n      camera.viewportToWorldPoint(tempVec3, this.startPointerPos);\n    };\n\n    _proto.onPointerDrag = function onPointerDrag() {\n      var tempVec2 = this.tempVec2,\n          tempVec3 = this.tempVec3,\n          startPointerPos = this.startPointerPos;\n      var transform = this.entity.transform; // @ts-ignore\n\n      this.getMergePointer(inputManager.pointers, tempVec2);\n      this.tempVec3.setValue(tempVec2.x * invCanvasWidth, tempVec2.y * invCanvasHeight, this.zValue);\n      camera.viewportToWorldPoint(tempVec3, tempVec3);\n\n      _oasisEngine.Vector3.subtract(tempVec3, startPointerPos, startPointerPos);\n\n      transform.worldPosition = transform.worldPosition.add(startPointerPos);\n      tempVec3.cloneTo(startPointerPos);\n    };\n\n    _proto.getMergePointer = function getMergePointer(pointers, out) {\n      pointers[0].position.cloneTo(out);\n      var len = pointers.length;\n\n      for (var i = 1; i < len; i++) {\n        var pos = pointers[i].position;\n        out.x += pos.x;\n        out.y += pos.y;\n      }\n    };\n\n    return PanScript;\n  }(_oasisEngine.Script);\n\n  var ClickScript = /*#__PURE__*/function (_Script2) {\n    _inheritsLoose(ClickScript, _Script2);\n\n    function ClickScript() {\n      var _this2;\n\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      _this2 = _Script2.call.apply(_Script2, [this].concat(args)) || this;\n      _this2.material = void 0;\n      return _this2;\n    }\n\n    var _proto2 = ClickScript.prototype;\n\n    _proto2.onStart = function onStart() {\n      this.material = this.entity.getComponent(_oasisEngine.MeshRenderer).getInstanceMaterial();\n    };\n\n    _proto2.onPointerClick = function onPointerClick() {\n      this.material.baseColor.setValue(Math.random(), Math.random(), Math.random(), 1.0);\n    };\n\n    return ClickScript;\n  }(_oasisEngine.Script);\n\n  var EnterExitScript = /*#__PURE__*/function (_Script3) {\n    _inheritsLoose(EnterExitScript, _Script3);\n\n    function EnterExitScript() {\n      var _this3;\n\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n\n      _this3 = _Script3.call.apply(_Script3, [this].concat(args)) || this;\n      _this3.material = void 0;\n      return _this3;\n    }\n\n    var _proto3 = EnterExitScript.prototype;\n\n    _proto3.onStart = function onStart() {\n      this.material = this.entity.getComponent(_oasisEngine.MeshRenderer).getInstanceMaterial();\n    };\n\n    _proto3.onPointerEnter = function onPointerEnter() {\n      this.material.baseColor.setValue(Math.random(), Math.random(), Math.random(), 1.0);\n    };\n\n    _proto3.onPointerExit = function onPointerExit() {\n      this.material.baseColor.setValue(Math.random(), Math.random(), Math.random(), 1.0);\n    };\n\n    return EnterExitScript;\n  }(_oasisEngine.Script);\n\n  function createBox(x, y, z) {\n    // create box test entity\n    var cubeSize = 2.0;\n    var boxEntity = rootEntity.createChild(\"BoxEntity\");\n    boxEntity.transform.setPosition(x, y, z);\n    var boxMtl = new _oasisEngine.BlinnPhongMaterial(engine);\n    var boxRenderer = boxEntity.addComponent(_oasisEngine.MeshRenderer);\n    boxMtl.baseColor.setValue(0.6, 0.3, 0.3, 1.0);\n    boxRenderer.mesh = _oasisEngine.PrimitiveMesh.createCuboid(engine, cubeSize, cubeSize, cubeSize);\n    boxRenderer.setMaterial(boxMtl);\n    var boxCollider = boxEntity.addComponent(_oasisEngine.StaticCollider);\n    var boxColliderShape = new _oasisEngine.BoxColliderShape();\n    boxColliderShape.setSize(cubeSize, cubeSize, cubeSize);\n    boxCollider.addShape(boxColliderShape);\n    return boxEntity;\n  }\n\n  createBox(0, 0, 0).addComponent(PanScript);\n  createBox(3, 0, -3).addComponent(ClickScript);\n  createBox(-3, 0, 3).addComponent(EnterExitScript); // Run engine\n\n  engine.run();\n});"},"name":"input-pointer","id":"5c74a2c5-5712-56ee-b501-9e0463fb2e3b"}}},"staticQueryHashes":[]}