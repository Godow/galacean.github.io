(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{bFeb:function(e,t,n){n("I+eb")({global:!0},{globalThis:n("2oRo")})},"j+VE":function(e,t,n){n("bFeb")},mI1M:function(e,t,n){n("j+VE"),function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var s=t.MathUtil.zeroTolerance,h=function(){function e(e,t,n){this.radius=e,this.phi=t,this.theta=n,this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0}var n=e.prototype;return n.set=function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},n.makeSafe=function(){return this.phi=t.MathUtil.clamp(this.phi,s,Math.PI-s),this},n.setFromVec3=function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(t.MathUtil.clamp(e.y/this.radius,-1,1))),this},n.setToVec3=function(e){var t=this.radius,n=this.phi,a=this.theta,i=Math.sin(n)*t;return e.set(i*Math.sin(a),t*Math.cos(n),i*Math.cos(a)),this},e}(),l=t.MathUtil.zeroTolerance;function p(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return n.some((function(t){return-1!==e.indexOf(t)}))}var c,d,u=function(e){function n(n){var a;return(a=e.call(this,n)||this)._forward=new t.Vector3,a._right=new t.Vector3,a.camera=void 0,a.mainElement=void 0,a.domElement=void 0,a.movementSpeed=void 0,a.rotateSpeed=void 0,a.floorMock=void 0,a.floorY=void 0,a.press=void 0,a.keysForward=void 0,a.keysBackward=void 0,a.keysLeft=void 0,a.keysRight=void 0,a._theta=void 0,a._phi=void 0,a._moveForward=void 0,a._moveBackward=void 0,a._moveLeft=void 0,a._moveRight=void 0,a._v3Cache=void 0,a._spherical=void 0,a._rotateOri=void 0,a._events=void 0,a.camera=n,a.mainElement=a.engine.canvas._webCanvas,a.domElement=document,a.movementSpeed=1,a.rotateSpeed=1,a.floorMock=!0,a.floorY=0,a.press=!1,a.keysForward=["KeyW","ArrowUp"],a.keysBackward=["KeyS","ArrowDown"],a.keysLeft=["KeyA","ArrowLeft"],a.keysRight=["KeyD","ArrowRight"],a._theta=0,a._phi=0,a._moveForward=!1,a._moveBackward=!1,a._moveLeft=!1,a._moveRight=!1,a._v3Cache=new t.Vector3,a._spherical=new h,a._rotateOri=[0,0],a._events=[{type:"mousemove",listener:a.onMouseMove.bind(r(a))},{type:"touchmove",listener:a.onMouseMove.bind(r(a))},{type:"mousedown",listener:a.onMouseDown.bind(r(a))},{type:"touchstart",listener:a.onMouseDown.bind(r(a))},{type:"mouseup",listener:a.onMouseUp.bind(r(a))},{type:"touchend",listener:a.onMouseUp.bind(r(a))},{type:"keydown",listener:a.onKeyDown.bind(r(a)),element:window},{type:"keyup",listener:a.onKeyUp.bind(r(a)),element:window},{type:"contextmenu",listener:a.onContextMenu.bind(r(a))}],a.initEvents(),a.updateSpherical(),a}i(n,e);var a=n.prototype;return a.onContextMenu=function(e){e.preventDefault()},a.onKeyDown=function(e){var t=e.code,n=e.key,a=e.keyCode;p(this.keysForward,t,n,a)?this._moveForward=!0:p(this.keysBackward,t,n,a)?this._moveBackward=!0:p(this.keysLeft,t,n,a)?this._moveLeft=!0:p(this.keysRight,t,n,a)&&(this._moveRight=!0)},a.onKeyUp=function(e){var t=e.code,n=e.key,a=e.keyCode;p(this.keysForward,t,n,a)?this._moveForward=!1:p(this.keysBackward,t,n,a)?this._moveBackward=!1:p(this.keysLeft,t,n,a)?this._moveLeft=!1:p(this.keysRight,t,n,a)&&(this._moveRight=!1)},a.onMouseDown=function(e){e.stopPropagation(),e=e.changedTouches&&e.changedTouches[0]||e,this.domElement!==document&&this.domElement.focus(),this.press=!0,this._rotateOri=[e.clientX,e.clientY]},a.onMouseUp=function(e){e.preventDefault(),e.stopPropagation(),this.press=!1},a.onMouseMove=function(e){if(!1!==this.press&&!1!==this.enabled){e.preventDefault(),e.stopPropagation();var t=(e=e.changedTouches&&e.changedTouches[0]||e).clientX-this._rotateOri[0],n=e.clientY-this._rotateOri[1];this._rotateOri[0]=e.clientX,this._rotateOri[1]=e.clientY;var a=t*(180/this.mainElement.width),i=n*(180/this.mainElement.height);this.rotate(-a,i)}},a.rotate=function(e,n){void 0===e&&(e=0),void 0===n&&(n=0),this._theta+=t.MathUtil.degreeToRadian(e),this._phi+=t.MathUtil.degreeToRadian(n),this._phi=t.MathUtil.clamp(this._phi,l,Math.PI-l),this._spherical.theta=this._theta,this._spherical.phi=this._phi,this._spherical.setToVec3(this._v3Cache),t.Vector3.add(this.camera.transform.position,this._v3Cache,this._v3Cache),this.camera.transform.lookAt(this._v3Cache,new t.Vector3(0,1,0))},a.onUpdate=function(e){if(!1!==this.enabled){var t=e/1e3*this.movementSpeed;if(this.camera.transform.getWorldForward(this._forward),this.camera.transform.getWorldRight(this._right),this._moveForward&&this.camera.transform.translate(this._forward.scale(t),!1),this._moveBackward&&this.camera.transform.translate(this._forward.scale(-t),!1),this._moveLeft&&this.camera.transform.translate(this._right.scale(-t),!1),this._moveRight&&this.camera.transform.translate(this._right.scale(t),!1),this.floorMock){var n=this.camera.transform.position;n.y!==this.floorY&&this.camera.transform.setPosition(n.x,this.floorY,n.z)}}},a.initEvents=function(){var e=this;this._events.forEach((function(t){t.element?t.element.addEventListener(t.type,t.listener,!1):e.mainElement.addEventListener(t.type,t.listener,!1)}))},a.onDestroy=function(){var e=this;this._events.forEach((function(t){t.element?t.element.removeEventListener(t.type,t.listener,!1):e.mainElement.removeEventListener(t.type,t.listener,!1)}))},a.updateSpherical=function(){this._v3Cache.set(0,0,-1),t.Vector3.transformByQuat(this._v3Cache,this.camera.transform.rotationQuaternion,this._v3Cache),this._spherical.setFromVec3(this._v3Cache),this._theta=this._spherical.theta,this._phi=this._spherical.phi},n}(t.Script);function m(){return function(e){}}e.ControlHandlerType=void 0,(d=e.ControlHandlerType||(e.ControlHandlerType={}))[d.None=0]="None",d[d.ROTATE=1]="ROTATE",d[d.ZOOM=2]="ZOOM",d[d.PAN=4]="PAN",d[d.All=7]="All";var _,f,y,v=void(c=function(){function n(){}return n.onUpdateHandler=function(n){return n.isKeyHeldDown(t.Keys.ArrowLeft)||n.isKeyHeldDown(t.Keys.ArrowRight)||n.isKeyHeldDown(t.Keys.ArrowUp)||n.isKeyHeldDown(t.Keys.ArrowDown)?e.ControlHandlerType.PAN:e.ControlHandlerType.None},n.onUpdateDelta=function(e,n){var a=e.keyPanSpeed,i=e.input;n.x=n.y=0,i.isKeyHeldDown(t.Keys.ArrowLeft)&&(n.x+=a),i.isKeyHeldDown(t.Keys.ArrowRight)&&(n.x-=a),i.isKeyHeldDown(t.Keys.ArrowUp)&&(n.y+=a),i.isKeyHeldDown(t.Keys.ArrowDown)&&(n.y-=a)},n}())||c;!function(e){e[e.Moving=0]="Moving",e[e.Distance=1]="Distance"}(y||(y={}));var T,w=((f=function(){function n(){}return n.onUpdateHandler=function(n){switch(++this._frameIndex,n.pointers.length){case 1:n.isPointerHeldDown(t.PointerButton.Secondary)?this._updateType(e.ControlHandlerType.PAN,y.Moving):n.isPointerHeldDown(t.PointerButton.Auxiliary)?this._updateType(e.ControlHandlerType.ZOOM,y.Moving):n.isPointerHeldDown(t.PointerButton.Primary)?this._updateType(e.ControlHandlerType.ROTATE,y.Moving):this._updateType(e.ControlHandlerType.None,y.Moving);break;case 2:this._updateType(e.ControlHandlerType.ZOOM,y.Distance);break;case 3:this._updateType(e.ControlHandlerType.PAN,y.Moving);break;default:this._updateType(e.ControlHandlerType.None,y.Moving)}return this._handlerType},n.onUpdateDelta=function(e,n){var a=this._frameIndex;switch(this._deltaType){case y.Moving:if(this._lastUsefulFrameIndex===a-1){var i=e.input.pointerMovingDelta;n.x=i.x,n.y=i.y}else n.x=0,n.y=0;break;case y.Distance:var o=e.input.pointers,r=o[0],s=o[1],h=t.Vector2.distance(r.position,s.position);this._lastUsefulFrameIndex===a-1?n.set(0,this._distanceOfPointers-h,0):n.set(0,0,0),this._distanceOfPointers=h}this._lastUsefulFrameIndex=a},n._updateType=function(e,t){this._handlerType===e&&this._deltaType===t||(this._handlerType=e,this._deltaType=t,this._lastUsefulFrameIndex=-1)},n}())._deltaType=y.Moving,f._handlerType=e.ControlHandlerType.None,f._frameIndex=0,f._lastUsefulFrameIndex=-1,f._distanceOfPointers=0,void(_=f)||_),g=void(T=function(){function t(){}return t.onUpdateHandler=function(t){var n=t.wheelDelta;return 0===n.x&&0===n.y&&0===n.z?e.ControlHandlerType.None:e.ControlHandlerType.ZOOM},t.onUpdateDelta=function(e,t){t.copyFrom(e.input.wheelDelta)},t}())||T,H=function(n){function o(){for(var a,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(a=n.call.apply(n,[this].concat(o))||this).canvas=void 0,a.input=void 0,a.inputDevices=[v,w,g],a.camera=void 0,a.cameraTransform=void 0,a.target=new t.Vector3,a.up=new t.Vector3(0,1,0),a.autoRotate=!1,a.autoRotateSpeed=Math.PI,a.enableKeys=!1,a.enableDamping=!0,a.rotateSpeed=1,a.zoomSpeed=1,a.keyPanSpeed=7,a.dampingFactor=.1,a.zoomFactor=.2,a.minDistance=.1,a.maxDistance=1/0,a.minZoom=0,a.maxZoom=1/0,a.minPolarAngle=0,a.maxPolarAngle=Math.PI,a.minAzimuthAngle=-1/0,a.maxAzimuthAngle=1/0,a._spherical=new h,a._sphericalDelta=new h,a._sphericalDump=new h,a._zoomFrag=0,a._scale=1,a._panOffset=new t.Vector3,a._tempVec3=new t.Vector3,a._enableHandler=e.ControlHandlerType.All,a}i(o,n);var r=o.prototype;return r.onAwake=function(){var e=this.engine,n=this.entity;this.canvas=e.canvas,this.input=e.inputManager,this.camera=n.getComponent(t.Camera),this.cameraTransform=n.transform},r.onUpdate=function(e){this._updateInputDelta(e),this._updateTransform()},r._updateInputDelta=function(t){for(var n=e.ControlHandlerType.None,a=this._tempVec3,i=this._enableHandler,o=this.inputDevices,r=this.input,s=o.length-1;s>=0;s--){var h=o[s],l=h.onUpdateHandler(r);if(l&i)switch(n|=l,h.onUpdateDelta(this,a),l){case e.ControlHandlerType.ROTATE:this._rotate(a);break;case e.ControlHandlerType.ZOOM:this._zoom(a);break;case e.ControlHandlerType.PAN:this._pan(a)}}var p=this._sphericalDump,c=this._sphericalDelta;if(this.autoRotate){var d=this.autoRotateSpeed/1e3*t;this._sphericalDelta.theta-=d}this.enableDamping&&(i&e.ControlHandlerType.ZOOM&&n^e.ControlHandlerType.ZOOM&&(this._zoomFrag*=1-this.zoomFactor),i&e.ControlHandlerType.ROTATE&&n^e.ControlHandlerType.ROTATE&&(c.theta=p.theta*=1-this.dampingFactor,c.phi=p.phi*=1-this.dampingFactor))},r._rotate=function(e){var t=2*Math.PI*e.x/this.canvas.width*this.rotateSpeed;this._sphericalDelta.theta-=t;var n=2*Math.PI*e.y/this.canvas.height*this.rotateSpeed;this._sphericalDelta.phi-=n,this.enableDamping&&(this._sphericalDump.theta=-t,this._sphericalDump.phi=-n)},r._zoom=function(e){e.y>0?this._scale/=Math.pow(.95,this.zoomSpeed):e.y<0&&(this._scale*=Math.pow(.95,this.zoomSpeed))},r._pan=function(e){var n=this.cameraTransform,a=n.worldMatrix.elements,i=this.canvas.height,o=t.Vector3.distance(n.position,this.target)*(this.camera.fieldOfView/2)*(Math.PI/180),r=-2*e.x*(o/i),s=2*e.y*(o/i);this._panOffset.x+=a[0]*r+a[4]*s,this._panOffset.y+=a[1]*r+a[5]*s,this._panOffset.z+=a[2]*r+a[6]*s},r._updateTransform=function(){var e=this.cameraTransform,n=this.target,a=this._tempVec3,i=this._spherical,o=this._sphericalDelta,r=this._panOffset;t.Vector3.subtract(e.position,n,a),i.setFromVec3(a),i.theta+=o.theta,i.phi+=o.phi,i.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,i.theta)),i.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,i.phi)),i.makeSafe(),1!==this._scale&&(this._zoomFrag=i.radius*(this._scale-1)),i.radius+=this._zoomFrag,i.radius=Math.max(this.minDistance,Math.min(this.maxDistance,i.radius)),i.setToVec3(a),t.Vector3.add(n.add(r),a,e.position),e.lookAt(n,this.up),this._zoomFrag=0,this._scale=1,o.set(0,0,0),r.set(0,0,0)},a(o,[{key:"enableRotate",get:function(){return 0!=(this._enableHandler&e.ControlHandlerType.ROTATE)},set:function(t){t?this._enableHandler|=e.ControlHandlerType.ROTATE:this._enableHandler&=~e.ControlHandlerType.ROTATE}},{key:"enableZoom",get:function(){return 0!=(this._enableHandler&e.ControlHandlerType.ZOOM)},set:function(t){t?this._enableHandler|=e.ControlHandlerType.ZOOM:this._enableHandler&=~e.ControlHandlerType.ZOOM}},{key:"enablePan",get:function(){return 0!=(this._enableHandler&e.ControlHandlerType.PAN)},set:function(t){t?this._enableHandler|=e.ControlHandlerType.PAN:this._enableHandler&=~e.ControlHandlerType.PAN}}]),o}(t.Script),M=function(n){function o(a){var i;return(i=n.call(this,a)||this).canvas=void 0,i.input=void 0,i.inputDevices=[v,w,g],i.camera=void 0,i.cameraTransform=void 0,i.target=new t.Vector3,i.up=new t.Vector3(0,1,0),i.autoRotate=!1,i.autoRotateSpeed=Math.PI,i.enableKeys=!1,i.enableDamping=!0,i.rotateSpeed=1,i.zoomSpeed=1,i.keyPanSpeed=7,i.dampingFactor=.1,i.zoomFactor=.2,i.minDistance=.1,i.maxDistance=1/0,i.minZoom=0,i.maxZoom=1/0,i.minPolarAngle=0,i.maxPolarAngle=Math.PI,i.minAzimuthAngle=-1/0,i.maxAzimuthAngle=1/0,i._zoomScaleUnit=25,i._scale=1,i._panOffset=new t.Vector3,i._tempVec3=new t.Vector3,i._enableHandler=e.ControlHandlerType.All,i.enableRotate=!1,i}i(o,n);var r=o.prototype;return r.onAwake=function(){var e=this.engine,n=this.entity;this.canvas=e.canvas,this.input=e.inputManager,this.camera=n.getComponent(t.Camera),this.cameraTransform=n.transform},r.onUpdate=function(e){this._updateInputDelta(e),this._updateCamera()},r._updateInputDelta=function(t){e.ControlHandlerType.None;for(var n=this._tempVec3,a=this._enableHandler,i=this.inputDevices,o=this.input,r=i.length-1;r>=0;r--){var s=i[r],h=s.onUpdateHandler(o);if(h&a)switch(s.onUpdateDelta(this,n),h){case e.ControlHandlerType.ZOOM:this._zoom(n);break;case e.ControlHandlerType.PAN:this._pan(n)}}},r._zoom=function(e){e.y>0?this._scale/=Math.pow(.95,this.zoomSpeed):e.y<0&&(this._scale*=Math.pow(.95,this.zoomSpeed))},r._pan=function(e){this._panOffset.copyFrom(e)},r._updateCamera=function(){var e=this.cameraTransform,t=this.camera,n=this._panOffset,a=this._zoomScaleUnit*(this._scale-1),i=t.orthographicSize+a;t.orthographicSize=Math.max(this.minZoom,Math.min(this.maxZoom,i));var o=this.canvas,r=o.width,s=o.height,h=n.x,l=n.y,p=2*t.orthographicSize,c=p*t.aspectRatio,d=p,u=e.position,m=this._tempVec3;m.x=u.x-h*c/r,m.y=u.y+l*d/s,m.z=u.z,e.position=m,this._scale=1,n.set(0,0,0)},a(o,[{key:"enableRotate",get:function(){return 0!=(this._enableHandler&e.ControlHandlerType.ROTATE)},set:function(t){t?this._enableHandler|=e.ControlHandlerType.ROTATE:this._enableHandler&=~e.ControlHandlerType.ROTATE}},{key:"enableZoom",get:function(){return 0!=(this._enableHandler&e.ControlHandlerType.ZOOM)},set:function(t){t?this._enableHandler|=e.ControlHandlerType.ZOOM:this._enableHandler&=~e.ControlHandlerType.ZOOM}},{key:"enablePan",get:function(){return 0!=(this._enableHandler&e.ControlHandlerType.PAN)},set:function(t){t?this._enableHandler|=e.ControlHandlerType.PAN:this._enableHandler&=~e.ControlHandlerType.PAN}}]),o}(t.Script);e.ControlKeyboard=v,e.ControlPointer=w,e.ControlWheel=g,e.FreeControl=u,e.OrbitControl=H,e.OrthoControl=M,e.StaticInterfaceImplement=m,Object.defineProperty(e,"__esModule",{value:!0})}(t,n("iJzs"))}}]);