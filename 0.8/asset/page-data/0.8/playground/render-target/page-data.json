{"componentChunkName":"component---src-templates-playground-tsx","path":"/0.8/playground/render-target","result":{"pageContext":{"node":{"internal":{"content":"(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"@oasis-engine-toolkit/controls\", \"oasis-engine\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(require(\"@oasis-engine-toolkit/controls\"), require(\"oasis-engine\"));\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(global[\"@oasisEngineToolkit/controls\"], global.oasisEngine);\n    global.index = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_controls, _oasisEngine) {\n  \"use strict\";\n\n  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }\n\n  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n  // Create scene\n  var engine = new _oasisEngine.WebGLEngine(\"canvas\");\n  engine.canvas.resizeByClientSize();\n  var scene = engine.sceneManager.activeScene;\n  var rootEntity = scene.createRootEntity();\n  var cameraEntity = rootEntity.createChild(\"camera\");\n  cameraEntity.addComponent(_oasisEngine.Camera);\n  cameraEntity.transform.setPosition(0, 0, 10);\n  var control = cameraEntity.addComponent(_controls.OrbitControl);\n  control.minDistance = 3;\n  scene.ambientLight.diffuseSolidColor.set(1, 1, 1, 1); // Create planes to mock mirror\n\n  var planeEntity = rootEntity.createChild(\"mirror\");\n  var planeRenderer = planeEntity.addComponent(_oasisEngine.MeshRenderer);\n\n  var mesh = _oasisEngine.PrimitiveMesh.createPlane(engine, 2, 2);\n\n  var material = new _oasisEngine.UnlitMaterial(engine);\n  planeEntity.transform.setRotation(90, 0, 0);\n  material.renderFace = _oasisEngine.RenderFace.Double;\n  planeRenderer.mesh = mesh;\n  planeRenderer.setMaterial(material);\n\n  for (var i = 0; i < 8; i++) {\n    var clone = planeEntity.clone();\n    planeEntity.parent.addChild(clone);\n    clone.layer = _oasisEngine.Layer.Layer1;\n    clone.transform.setPosition((i - 4) * 2, 0, i % 2 ? -5 : -8);\n  }\n\n  planeEntity.isActive = false; // Create sky\n\n  var background = scene.background;\n  var sky = background.sky;\n  var skyMaterial = new _oasisEngine.SkyBoxMaterial(engine);\n  background.mode = _oasisEngine.BackgroundMode.Sky;\n  sky.material = skyMaterial;\n  sky.mesh = _oasisEngine.PrimitiveMesh.createCuboid(engine, 1, 1, 1);\n  engine.resourceManager.load({\n    urls: [\"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*Gi7CTZqKuacAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*iRRMQIExwKMAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*ZIcPQZo20sAAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*SPYuTbHT-KgAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*mGUERbY77roAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*ilkPS7A1_JsAAAAAAAAAAABkARQnAQ\"],\n    type: _oasisEngine.AssetType.TextureCube\n  }).then(function (cubeMap) {\n    scene.ambientLight.specularTexture = cubeMap;\n    skyMaterial.textureCubeMap = cubeMap;\n  }); // Load glTF\n\n  engine.resourceManager.load(\"https://gw.alipayobjects.com/os/bmw-prod/8cc524dd-2481-438d-8374-3c933adea3b6.gltf\").then(function (gltf) {\n    var animations = gltf.animations,\n        defaultSceneRoot = gltf.defaultSceneRoot;\n    rootEntity.addChild(defaultSceneRoot);\n    var animator = defaultSceneRoot.getComponent(_oasisEngine.Animator);\n    animator.play(animations[0].name);\n  }); // Add script to switch `camera.renderTarget`\n\n  var switchRTScript = /*#__PURE__*/function (_Script) {\n    _inheritsLoose(switchRTScript, _Script);\n\n    function switchRTScript(entity) {\n      var _this;\n\n      _this = _Script.call(this, entity) || this;\n      _this.renderColorTexture = new _oasisEngine.Texture2D(engine, 1024, 1024);\n      _this.renderTarget = new _oasisEngine.RenderTarget(engine, 1024, 1024, _this.renderColorTexture);\n      material.baseTexture = _this.renderColorTexture;\n      return _this;\n    }\n\n    var _proto = switchRTScript.prototype;\n\n    _proto.onBeginRender = function onBeginRender(camera) {\n      camera.renderTarget = this.renderTarget;\n      camera.cullingMask = _oasisEngine.Layer.Layer0;\n      camera.render();\n      camera.renderTarget = null;\n      camera.cullingMask = _oasisEngine.Layer.Everything;\n    };\n\n    return switchRTScript;\n  }(_oasisEngine.Script);\n\n  cameraEntity.addComponent(switchRTScript);\n  engine.run();\n});"},"name":"render-target","id":"b38210e4-4c28-55df-a8f9-2278e614648f"}}},"staticQueryHashes":[]}