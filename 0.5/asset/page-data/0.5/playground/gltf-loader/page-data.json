{"componentChunkName":"component---src-templates-playground-tsx","path":"/0.5/playground/gltf-loader","result":{"pageContext":{"node":{"internal":{"content":"(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"@oasis-engine/controls\", \"dat.gui\", \"oasis-engine\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(require(\"@oasis-engine/controls\"), require(\"dat.gui\"), require(\"oasis-engine\"));\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(global[\"@oasisEngine/controls\"], global.dat, global.oasisEngine);\n    global.index = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_controls, dat, _oasisEngine) {\n  \"use strict\";\n\n  dat = _interopRequireWildcard(dat);\n\n  function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\n  function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n  /**\n   * @title GLTF Loader\n   * @category Advance\n   */\n  _oasisEngine.Logger.enable();\n\n  var envList = {\n    sky: {\n      url: [\"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*Gi7CTZqKuacAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*iRRMQIExwKMAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*ZIcPQZo20sAAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*SPYuTbHT-KgAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*mGUERbY77roAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*ilkPS7A1_JsAAAAAAAAAAABkARQnAQ\"],\n      sh: [1.4536975622177124, 1.2322516441345215, 0.8864129185676575, -0.44435063004493713, -0.2984199821949005, -0.04654404893517494, 0.2504007816314697, 0.23473940789699554, 0.10485957562923431, -0.22722581028938293, -0.23118487000465393, -0.1346835047006607, 0.2024701088666916, 0.18827538192272186, 0.07655547559261322, -0.26720723509788513, -0.24846990406513214, -0.1269611418247223, 0.1128435879945755, 0.07063852250576019, 0.008191842585802078, -0.06712324172258377, -0.12072498351335526, -0.10238106548786163, 0.1859109252691269, 0.10431329905986786, -0.017114786431193352]\n    },\n    house: {\n      url: [\"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*1gjTQ7P2mQoAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*entSR7DylL0AAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*izQBQY_vs_4AAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*x3XnRpq1U-EAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*k7FsT5Gprn0AAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*8LdBQ6ixiQAAAAAAAAAAAABkARQnAQ\"],\n      sh: [0.8962685465812683, 0.7656264901161194, 0.5087476968765259, -0.5958908200263977, -0.47178128361701965, -0.4705639183521271, 0.12607601284980774, 0.059399981051683426, 0.029415369033813477, -0.12036323547363281, -0.08801775425672531, -0.06222928687930107, 0.10942810773849487, 0.07969340682029724, 0.07417184114456177, 0.040593646466732025, 0.0655241310596466, 0.05116600915789604, -0.0007216486847028136, 0.013710534200072289, -0.03733639046549797, -0.17561253905296326, -0.1475340873003006, -0.10067987442016602, -0.24986475706100464, -0.21295468509197235, -0.25329700112342834]\n    },\n    sunnyDay: {\n      url: [\"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*4ZY8T4GpKwYAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*8QbJQZwS1wUAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*a54kSZ3LmAQAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*8CbfTb1yG8MAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*Yi4ZRZbdj8MAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*KddxSriLYjoAAAAAAAAAAABkARQnAQ\"],\n      sh: [0.49732351303100586, 0.8204453587532043, 1.1980727910995483, -0.047882016748189926, 0.019423319026827812, 0.061979617923498154, -0.05293811112642288, -0.05558563023805618, -0.05352041870355606, 0.018472276628017426, 0.01944858208298683, 0.02016768604516983, -0.011690393090248108, -0.015611638315021992, -0.01910223439335823, 0.03366464003920555, 0.041282784193754196, 0.04779789596796036, 0.358532577753067, 0.4352142810821533, 0.44211071729660034, -0.11810286343097687, -0.12507741153240204, -0.1150369867682457, 0.33062830567359924, 0.44129398465156555, 0.47715216875076294]\n    },\n    miniSampler: {\n      url: [\"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*IuyGR4bdwg4AAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*4rv5RZ0kll4AAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*cHitTpWoJjoAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*RCEbS6k5x18AAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*IRc7R7cl4CcAAAAAAAAAAABkARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_475770/afts/img/A*y_4hRYVgzQ4AAAAAAAAAAABkARQnAQ\"],\n      sh: [0.20824000239372253, 0.23156625032424927, 0.30640628933906555, -0.032208919525146484, -0.03681790828704834, -0.08673757314682007, 0.026594972237944603, 0.04329078644514084, 0.06584044545888901, -0.18646225333213806, -0.25607162714004517, -0.3791993260383606, 0.040871474891901016, 0.0778534933924675, 0.1789904683828354, 0.022585343569517136, 0.010101129300892353, -0.004903033375740051, -0.04522740840911865, -0.0497514046728611, -0.09917914122343063, -0.00019472345593385398, -0.01602073200047016, -0.051514893770217896, 0.11432443559169769, 0.18823105096817017, 0.2658124566078186]\n    },\n    road: {\n      url: [\"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*4ebgQaWOLaIAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*i56eR6AbreUAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*3wYERKsel5oAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*YiG7Srwmb3QAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*VUUwQrAv47sAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*Dn2qSoqzfwoAAAAAAAAAAAAAARQnAQ\"],\n      sh: [0.2990323305130005, 0.46782827377319336, 0.6490488052368164, -0.08325951546430588, -0.1739923506975174, -0.3481740653514862, 0.12110518664121628, 0.10342133790254593, 0.0647989809513092, 0.013654923066496849, 0.019375042989850044, 0.019014855846762657, -0.010647064074873924, -0.0158681683242321, -0.01735353097319603, -0.06292672455310822, -0.06085652485489845, -0.04486454278230667, 0.19867956638336182, 0.21928717195987701, 0.19299709796905518, 0.01943504437804222, 0.03246982768177986, 0.04340629279613495, 0.13364768028259277, 0.19655625522136688, 0.21748234331607819]\n    }\n  };\n\n  var Oasis = /*#__PURE__*/function () {\n    Oasis.guiToColor = function guiToColor(gui, color) {\n      color.setValue(gui[0] / 255, gui[1] / 255, gui[2] / 255, color.a);\n    };\n\n    Oasis.colorToGui = function colorToGui(color) {\n      if (color === void 0) {\n        color = new _oasisEngine.Color(1, 1, 1);\n      }\n\n      var v = [];\n      v[0] = color.r * 255;\n      v[1] = color.g * 255;\n      v[2] = color.b * 255;\n      return v;\n    };\n\n    function Oasis() {\n      var _this = this;\n\n      this.cubeTextures = {};\n      this.sh = {};\n      this.textures = {};\n      this.engine = new _oasisEngine.WebGLEngine(\"canvas\");\n      this.scene = this.engine.sceneManager.activeScene;\n      this.skyMaterial = new _oasisEngine.SkyBoxMaterial(this.engine);\n      this.rootEntity = this.scene.createRootEntity(\"root\");\n      this.cameraEntity = this.rootEntity.createChild(\"camera\");\n      this.gltfRootEntity = this.rootEntity.createChild(\"gltf\");\n      this.lightEntity1 = this.rootEntity.createChild(\"direct_light1\");\n      this.lightEntity2 = this.rootEntity.createChild(\"direct_light2\");\n      this.camera = this.cameraEntity.addComponent(_oasisEngine.Camera);\n      this.controler = this.cameraEntity.addComponent(_controls.OrbitControl);\n      this.light1 = this.lightEntity1.addComponent(_oasisEngine.DirectLight);\n      this.light2 = this.lightEntity2.addComponent(_oasisEngine.DirectLight);\n      this.gui = new dat.GUI();\n      this.materialFolder = null;\n      this.animationFolder = null;\n      this.state = {\n        // Scene\n        background: false,\n        // Lights\n        envTexture: \"miniSampler\",\n        envIntensity: 1,\n        addLights: true,\n        lightColor: Oasis.colorToGui(new _oasisEngine.Color(1, 1, 1)),\n        lightIntensity: 0.8,\n        // GLTF Model List\n        defaultGLTF: \"fox\",\n        gltfList: {\n          \"2CylinderEngine\": \"https://gw.alipayobjects.com/os/bmw-prod/48a1e8b3-06b4-4269-807d-79274e58283a.glb\",\n          alphaBlendModeTest: \"https://gw.alipayobjects.com/os/bmw-prod/d099b30b-59a3-42e4-99eb-b158afa8e65d.glb\",\n          animatedCube: \"https://gw.alipayobjects.com/os/bmw-prod/8cc524dd-2481-438d-8374-3c933adea3b6.gltf\",\n          antiqueCamera: \"https://gw.alipayobjects.com/os/bmw-prod/93196534-bab3-4559-ae9f-bcb3e36a6419.glb\",\n          avocado: \"https://gw.alipayobjects.com/os/bmw-prod/0f978c4d-1cd6-4cec-9a4c-b58c8186e063.glb\",\n          avocado_draco: \"https://gw.alipayobjects.com/os/bmw-prod/b3b73614-cf06-4f41-940d-c1bc04cf6410.gltf\",\n          avocado_specular: \"https://gw.alipayobjects.com/os/bmw-prod/3cf50452-0015-461e-a172-7ea1f8135e53.gltf\",\n          avocado_quantized: \"https://gw.alipayobjects.com/os/bmw-prod/6aff5409-8e82-4e77-a6ac-55b6adfd0cf5.gltf\",\n          barramundiFish: \"https://gw.alipayobjects.com/os/bmw-prod/79d7935c-404b-4d8d-9ad3-5f8c273f0e4a.glb\",\n          boomBox: \"https://gw.alipayobjects.com/os/bmw-prod/2e98b1c0-18e8-45d0-b54e-dcad6ef05e22.glb\",\n          boomBoxWithAxes: \"https://gw.alipayobjects.com/os/bmw-prod/96e1b8b2-9be6-4b64-98ea-8c008c6dc422.gltf\",\n          boxVertexColors: \"https://gw.alipayobjects.com/os/bmw-prod/6cff6fcb-5191-465e-9a38-dee42a07cc65.glb\",\n          brianStem: \"https://gw.alipayobjects.com/os/bmw-prod/e3b37dd9-9407-4b5c-91b3-c5880d081329.glb\",\n          buggy: \"https://gw.alipayobjects.com/os/bmw-prod/d6916a14-b004-42d5-86dd-d8520b719288.glb\",\n          cesiumMan: \"https://gw.alipayobjects.com/os/bmw-prod/3a7d9597-7354-4bef-b314-b84509bef9b6.glb\",\n          cesiumMilkTruck: \"https://gw.alipayobjects.com/os/bmw-prod/7701125a-7d0d-4281-a7d8-7f0dfc8d0792.glb\",\n          corset: \"https://gw.alipayobjects.com/os/bmw-prod/3deaa5a4-5b2a-4a0d-8512-a8c4377a08ff.glb\",\n          DamagedHelmet: \"https://gw.alipayobjects.com/os/bmw-prod/a1da72a4-023e-4bb1-9629-0f4b0f6b6fc4.glb\",\n          Duck: \"https://gw.alipayobjects.com/os/bmw-prod/6cb8f543-285c-491a-8cfd-57a1160dc9ab.glb\",\n          environmentTest: \"https://gw.alipayobjects.com/os/bmw-prod/7c7b887c-05d6-43dd-b354-216e738e81ed.gltf\",\n          flightHelmet: \"https://gw.alipayobjects.com/os/bmw-prod/d6dbf161-48e2-4e6d-bbca-c481ed9f1a2d.gltf\",\n          fox: \"https://gw.alipayobjects.com/os/bmw-prod/f40ef8dd-4c94-41d4-8fac-c1d2301b6e47.glb\",\n          animationInterpolationTest: \"https://gw.alipayobjects.com/os/bmw-prod/4f410ef2-20b4-494d-85f1-a806c5070bfb.glb\",\n          lantern: \"https://gw.alipayobjects.com/os/bmw-prod/9557420a-c622-4e9c-bb46-f7af8b19d7de.glb\",\n          materialsVariantsShoe: \"https://gw.alipayobjects.com/os/bmw-prod/b1a414bb-61ea-4667-94d2-ef6cf179ac0d.glb\",\n          metalRoughSpheres: \"https://gw.alipayobjects.com/os/bmw-prod/67b39ede-1c82-4321-8457-0ad83ca9413a.glb\",\n          normalTangentTest: \"https://gw.alipayobjects.com/os/bmw-prod/4bb1a66c-55e3-4898-97d7-a9cc0f239686.glb\",\n          normalTangentMirrorTest: \"https://gw.alipayobjects.com/os/bmw-prod/8335f555-2061-47f5-9252-366c6ebf882a.glb\",\n          orientationTest: \"https://gw.alipayobjects.com/os/bmw-prod/16cdf390-ac42-411c-9d2b-8e112dfd723b.glb\",\n          sparseTest: \"https://gw.alipayobjects.com/os/bmw-prod/f00de659-53ea-49d1-8f2c-d0a412542b80.gltf\",\n          specGlossVsMetalRough: \"https://gw.alipayobjects.com/os/bmw-prod/4643bd7b-f988-4144-8245-4a390023d92d.glb\",\n          sponza: \"https://gw.alipayobjects.com/os/bmw-prod/ca50859b-d736-4a3e-9fc3-241b0bd2afef.gltf\",\n          suzanne: \"https://gw.alipayobjects.com/os/bmw-prod/3869e495-2e04-4e80-9d22-13b37116379a.gltf\",\n          sheenChair: \"https://gw.alipayobjects.com/os/bmw-prod/34847225-bc1b-4bef-9cb9-6b9711ca2f8c.glb\",\n          sheenCloth: \"https://gw.alipayobjects.com/os/bmw-prod/4529d2e8-22a8-47af-9b38-8eaff835f6bf.gltf\",\n          textureCoordinateTest: \"https://gw.alipayobjects.com/os/bmw-prod/5fd23201-51dd-4eea-92d3-c4a72ecc1f2b.glb\",\n          textureEncodingTest: \"https://gw.alipayobjects.com/os/bmw-prod/b8795e57-3c2c-4412-b4f0-7ffa796e4917.glb\",\n          textureSettingTest: \"https://gw.alipayobjects.com/os/bmw-prod/a4b26d58-bd49-4051-8f05-0fe8b532e716.glb\",\n          textureTransformMultiTest: \"https://gw.alipayobjects.com/os/bmw-prod/8fa18786-5188-4c14-94d7-77bf6b8483f9.glb\",\n          textureTransform: \"https://gw.alipayobjects.com/os/bmw-prod/6c59d5d0-2e2e-4933-a737-006d431977fd.gltf\",\n          toyCar: \"https://gw.alipayobjects.com/os/bmw-prod/8138b7d7-45aa-494a-8aea-0c67598b96d2.glb\",\n          transmissionTest: \"https://gw.alipayobjects.com/os/bmw-prod/1dd51fe8-bdd3-42e4-99be-53de5dc106b8.glb\",\n          unlitTest: \"https://gw.alipayobjects.com/os/bmw-prod/06a855be-ac8c-4705-b5d7-659b8b391189.glb\",\n          vc: \"https://gw.alipayobjects.com/os/bmw-prod/b71c4212-25fb-41bb-af88-d79ce6d3cc58.glb\",\n          vertexColorTest: \"https://gw.alipayobjects.com/os/bmw-prod/8fc70cc6-66d8-43c8-b460-f7d2aaa9edcf.glb\",\n          waterBottle: \"https://gw.alipayobjects.com/os/bmw-prod/0f403530-96f5-455a-8a39-b31ac68b6ed5.glb\"\n        }\n      };\n      this._materials = [];\n      this._boundingBox = new _oasisEngine.BoundingBox();\n      this._center = new _oasisEngine.Vector3();\n      this._extent = new _oasisEngine.Vector3();\n      this.initResources().then(function () {\n        _this.initScene();\n\n        _this.addGLTFList();\n\n        _this.addSceneGUI();\n      });\n    }\n\n    var _proto = Oasis.prototype;\n\n    _proto.initResources = function initResources() {\n      var _this2 = this;\n\n      var names = Object.keys(envList);\n      return new Promise(function (resolve) {\n        _this2.engine.resourceManager.load(names.map(function (name) {\n          return {\n            type: _oasisEngine.AssetType.TextureCube,\n            urls: envList[name].url\n          };\n        })).then(function (textures) {\n          textures.forEach(function (texture, index) {\n            var name = names[index];\n            _this2.cubeTextures[name] = texture;\n\n            if (envList[name].sh) {\n              var sh = new _oasisEngine.SphericalHarmonics3();\n              sh.setValueByArray(envList[name].sh);\n              _this2.sh[name] = sh;\n            } else {// const sh = new SphericalHarmonics3();\n              // SphericalHarmonics3Baker.fromTextureCubeMap(texture, sh);\n              // const out = [];\n              // sh.toArray(out);\n              // console.log(name, out);\n              // this.sh[name] = sh;\n            }\n\n            if (name === _this2.state.envTexture) {\n              _this2.scene.ambientLight.specularTexture = texture;\n              _this2.scene.ambientLight.diffuseMode = _oasisEngine.DiffuseMode.SphericalHarmonics;\n              _this2.scene.ambientLight.diffuseSphericalHarmonics = _this2.sh[name];\n              _this2.skyMaterial.textureCubeMap = texture;\n            }\n          });\n          resolve(true);\n        });\n      });\n    };\n\n    _proto.initScene = function initScene() {\n      this.engine.canvas.resizeByClientSize();\n      this.controler.minDistance = 0; // debug sync\n\n      if (this.state.background) {\n        this.scene.background.mode = _oasisEngine.BackgroundMode.Sky;\n      }\n\n      if (!this.state.addLights) {\n        this.light1.enabled = this.light2.enabled = false;\n      }\n\n      this.light1.intensity = this.light2.intensity = this.state.lightIntensity;\n      this.lightEntity1.transform.setRotation(30, 0, 0);\n      this.lightEntity2.transform.setRotation(-30, 180, 0);\n      this.scene.ambientLight.specularIntensity = this.state.envIntensity;\n      this.scene.background.sky.material = this.skyMaterial;\n      this.scene.background.sky.mesh = _oasisEngine.PrimitiveMesh.createCuboid(this.engine, 1, 1, 1);\n      this.engine.run();\n    };\n\n    _proto.addGLTFList = function addGLTFList() {\n      var _this3 = this;\n\n      this.loadGLTF(this.state.gltfList[this.state.defaultGLTF]);\n      this.gui.add(this.state, \"defaultGLTF\", Object.keys(this.state.gltfList)).name(\"GLTF List\").onChange(function (v) {\n        _this3.loadGLTF(_this3.state.gltfList[v]);\n      });\n    };\n\n    _proto.addSceneGUI = function addSceneGUI() {\n      var _this4 = this;\n\n      var gui = this.gui; // Display controls.\n\n      var dispFolder = gui.addFolder(\"Scene\");\n      dispFolder.add(this.state, \"background\").onChange(function (v) {\n        if (v) {\n          _this4.scene.background.mode = _oasisEngine.BackgroundMode.Sky;\n        } else {\n          _this4.scene.background.mode = _oasisEngine.BackgroundMode.SolidColor;\n        }\n      }); // Lighting controls.\n\n      var lightFolder = gui.addFolder(\"Lighting\");\n      lightFolder.add(this.state, \"envTexture\", [\"None\"].concat(Object.keys(this.cubeTextures))).name(\"IBL\").onChange(function (v) {\n        _this4.scene.ambientLight.specularTexture = _this4.skyMaterial.textureCubeMap = v === \"None\" ? null : _this4.cubeTextures[v];\n        _this4.scene.ambientLight.diffuseSphericalHarmonics = v === \"None\" ? null : _this4.sh[v];\n        _this4.scene.ambientLight.diffuseMode = v === \"None\" ? _oasisEngine.DiffuseMode.SolidColor : _oasisEngine.DiffuseMode.SphericalHarmonics;\n      });\n      lightFolder.add(this.scene.ambientLight, \"specularIntensity\", 0, 2);\n      lightFolder.add(this.scene.ambientLight, \"diffuseIntensity\", 0, 2);\n      lightFolder.add(this.state, \"addLights\").onChange(function (v) {\n        _this4.light1.enabled = _this4.light2.enabled = v;\n      }).name(\"直接光\");\n      lightFolder.addColor(this.state, \"lightColor\").onChange(function (v) {\n        Oasis.guiToColor(v, _this4.light1.color);\n        Oasis.guiToColor(v, _this4.light2.color);\n      });\n      lightFolder.add(this.state, \"lightIntensity\", 0, 2).onChange(function (v) {\n        _this4.light1.intensity = _this4.light2.intensity = v;\n      }).name(\"直接光强度\");\n    };\n\n    _proto.setCenter = function setCenter(renderers) {\n      var boundingBox = this._boundingBox;\n      var center = this._center;\n      var extent = this._extent;\n      boundingBox.min.setValue(0, 0, 0);\n      boundingBox.max.setValue(0, 0, 0);\n      renderers.forEach(function (renderer) {\n        _oasisEngine.BoundingBox.merge(renderer.bounds, boundingBox, boundingBox);\n      });\n      boundingBox.getExtent(extent);\n      var size = extent.length();\n      boundingBox.getCenter(center);\n      this.controler.target.setValue(center.x, center.y, center.z);\n      this.cameraEntity.transform.setPosition(center.x, center.y, size * 3);\n      this.camera.farClipPlane = size * 12;\n\n      if (this.camera.nearClipPlane > size) {\n        this.camera.nearClipPlane = size / 10;\n      } else {\n        this.camera.nearClipPlane = 0.1;\n      }\n\n      this.controler.maxDistance = size * 10;\n    };\n\n    _proto.loadGLTF = function loadGLTF(url) {\n      var _this5 = this;\n\n      this.destroyGLTF();\n      var isGLB = /.glb$/.test(url);\n      this.engine.resourceManager.load({\n        type: _oasisEngine.AssetType.Prefab,\n        url: url + \"#\" + Math.random() + \".\" + (isGLB ? \"glb\" : \"gltf\") // @todo: resourceManager cache bug\n\n      }).then(function (asset) {\n        var defaultSceneRoot = asset.defaultSceneRoot,\n            materials = asset.materials,\n            animations = asset.animations;\n        console.log(asset);\n        _this5.gltfRootEntity = defaultSceneRoot;\n\n        _this5.rootEntity.addChild(defaultSceneRoot);\n\n        var meshRenderers = [];\n        var skinnedMeshRenderers = [];\n        defaultSceneRoot.getComponentsIncludeChildren(_oasisEngine.MeshRenderer, meshRenderers);\n        defaultSceneRoot.getComponentsIncludeChildren(_oasisEngine.SkinnedMeshRenderer, skinnedMeshRenderers);\n\n        _this5.setCenter(meshRenderers.concat(skinnedMeshRenderers));\n\n        _this5.loadMaterialGUI(materials);\n\n        _this5.loadAnimationGUI(animations);\n      })[\"catch\"](function (e) {\n        console.error(e);\n      });\n    };\n\n    _proto.destroyGLTF = function destroyGLTF() {\n      this.gltfRootEntity.destroy();\n    };\n\n    _proto.loadMaterialGUI = function loadMaterialGUI(materials) {\n      var _this6 = this;\n\n      var gui = this.gui;\n\n      if (this.materialFolder) {\n        gui.removeFolder(this.materialFolder);\n        this.materialFolder = null;\n      }\n\n      if (!materials) {\n        materials = this._materials;\n      }\n\n      this._materials = materials;\n      if (!materials.length) return;\n      var folder = this.materialFolder = gui.addFolder(\"Material\");\n      var folderName = {};\n      materials.forEach(function (material) {\n        if (!(material instanceof _oasisEngine.PBRBaseMaterial) && !(material instanceof _oasisEngine.UnlitMaterial)) return;\n\n        if (!material.name) {\n          material.name = \"default\";\n        }\n\n        var state = {\n          opacity: material.baseColor.a,\n          baseColor: Oasis.colorToGui(material.baseColor),\n          emissiveColor: Oasis.colorToGui(material.emissiveColor),\n          specularColor: Oasis.colorToGui(material.specularColor),\n          baseTexture: material.baseTexture ? \"origin\" : \"\",\n          roughnessMetallicTexture: material.roughnessMetallicTexture ? \"origin\" : \"\",\n          normalTexture: material.normalTexture ? \"origin\" : \"\",\n          emissiveTexture: material.emissiveTexture ? \"origin\" : \"\",\n          occlusionTexture: material.occlusionTexture ? \"origin\" : \"\",\n          specularGlossinessTexture: material.specularGlossinessTexture ? \"origin\" : \"\"\n        };\n        var originTexture = {\n          baseTexture: material.baseTexture,\n          roughnessMetallicTexture: material.roughnessMetallicTexture,\n          normalTexture: material.normalTexture,\n          emissiveTexture: material.emissiveTexture,\n          occlusionTexture: material.occlusionTexture,\n          specularGlossinessTexture: material.specularGlossinessTexture\n        };\n        var f = folder.addFolder(folderName[material.name] ? material.name + \"_\" + (folderName[material.name] + 1) : material.name);\n        folderName[material.name] = folderName[material.name] == null ? 1 : folderName[material.name] + 1; // metallic\n\n        if (material instanceof _oasisEngine.PBRMaterial) {\n          var mode1 = f.addFolder(\"金属模式\");\n          mode1.add(material, \"metallic\", 0, 1).step(0.01);\n          mode1.add(material, \"roughness\", 0, 1).step(0.01);\n          mode1.add(state, \"roughnessMetallicTexture\", [\"None\", \"origin\"].concat(Object.keys(_this6.textures))).onChange(function (v) {\n            material.roughnessMetallicTexture = v === \"None\" ? null : _this6.textures[v] || originTexture.roughnessMetallicTexture;\n          });\n          mode1.open();\n        } // specular\n        else if (material instanceof _oasisEngine.PBRSpecularMaterial) {\n          var mode2 = f.addFolder(\"高光模式\");\n          mode2.add(material, \"glossiness\", 0, 1).step(0.01);\n          mode2.addColor(state, \"specularColor\").onChange(function (v) {\n            Oasis.guiToColor(v, material.specularColor);\n          });\n          mode2.add(state, \"specularGlossinessTexture\", [\"None\", \"origin\"].concat(Object.keys(_this6.textures))).onChange(function (v) {\n            material.specularGlossinessTexture = v === \"None\" ? null : _this6.textures[v] || originTexture.specularGlossinessTexture;\n          });\n          mode2.open();\n        } else if (material instanceof _oasisEngine.UnlitMaterial) {\n          f.add(state, \"baseTexture\", [\"None\", \"origin\"].concat(Object.keys(_this6.textures))).onChange(function (v) {\n            material.baseTexture = v === \"None\" ? null : _this6.textures[v] || originTexture.baseTexture;\n          });\n          f.addColor(state, \"baseColor\").onChange(function (v) {\n            Oasis.guiToColor(v, material.baseColor);\n          });\n        } // common\n\n\n        if (!(material instanceof _oasisEngine.UnlitMaterial)) {\n          var common = f.addFolder(\"通用\");\n          common.add(state, \"opacity\", 0, 1).step(0.01).onChange(function (v) {\n            material.baseColor.a = v;\n          });\n          common.add(material, \"isTransparent\");\n          common.add(material, \"alphaCutoff\", 0, 1).step(0.01);\n          common.addColor(state, \"baseColor\").onChange(function (v) {\n            Oasis.guiToColor(v, material.baseColor);\n          });\n          common.addColor(state, \"emissiveColor\").onChange(function (v) {\n            Oasis.guiToColor(v, material.emissiveColor);\n          });\n          common.add(state, \"baseTexture\", [\"None\", \"origin\"].concat(Object.keys(_this6.textures))).onChange(function (v) {\n            material.baseTexture = v === \"None\" ? null : _this6.textures[v] || originTexture.baseTexture;\n          });\n          common.add(state, \"normalTexture\", [\"None\", \"origin\"].concat(Object.keys(_this6.textures))).onChange(function (v) {\n            material.normalTexture = v === \"None\" ? null : _this6.textures[v] || originTexture.normalTexture;\n          });\n          common.add(state, \"emissiveTexture\", [\"None\", \"origin\"].concat(Object.keys(_this6.textures))).onChange(function (v) {\n            material.emissiveTexture = v === \"None\" ? null : _this6.textures[v] || originTexture.emissiveTexture;\n          });\n          common.add(state, \"occlusionTexture\", [\"None\", \"origin\"].concat(Object.keys(_this6.textures))).onChange(function (v) {\n            material.occlusionTexture = v === \"None\" ? null : _this6.textures[v] || originTexture.occlusionTexture;\n          });\n          common.open();\n        }\n      });\n    };\n\n    _proto.loadAnimationGUI = function loadAnimationGUI(animations) {\n      if (this.animationFolder) {\n        this.gui.removeFolder(this.animationFolder);\n        this.animationFolder = null;\n      }\n\n      if (animations != null && animations.length) {\n        this.animationFolder = this.gui.addFolder(\"Animation\");\n        this.animationFolder.open();\n        var animator = this.gltfRootEntity.getComponent(_oasisEngine.Animator);\n        animator.play(animations[0].name);\n        var state = {\n          animation: animations[0].name\n        };\n        this.animationFolder.add(state, \"animation\", [\"None\"].concat(animations.map(function (animation) {\n          return animation.name;\n        }))).onChange(function (name) {\n          if (name === \"None\") {\n            animator.speed = 0;\n          } else {\n            animator.speed = 1;\n            animator.play(name);\n          }\n        });\n      }\n    };\n\n    return Oasis;\n  }();\n\n  new Oasis();\n});"},"name":"gltf-loader","id":"201a5a32-f3d6-5a31-8ca6-0d20e89d6e08"}}},"staticQueryHashes":[]}